<ion-header>
  <ion-navbar color="primary">
    <ion-title>Asistencia</ion-title>
  </ion-navbar>

  <ion-toolbar no-border-top color="primary">
    <button ion-button icon-left color="secondary">
      <ion-icon name="calendar"></ion-icon>Cambiar fecha
      <ion-datetime displayFormat="DD/MM/YYYY" cancelText="CANCELAR" doneText="OK" [(ngModel)]="fecha" (ionChange)="ActualizarDia()"></ion-datetime>
    </button>
    
    <ion-segment color="light" [(ngModel)]="filtro">
      <ion-segment-button value="aula" (click)="ResetearElegidos()">AULA</ion-segment-button>
      <ion-segment-button value="materia" (click)="ResetearElegidos()">MATERIA</ion-segment-button>
      <ion-segment-button value="profesor" (click)="ResetearElegidos()">PROFESOR</ion-segment-button>
      <ion-segment-button value="alumno" (click)="ResetearElegidos()">ALUMNO</ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ion-header>

<ion-content padding scrollbar-y-auto>

  <div [ngSwitch]="filtro">
    <div *ngSwitchCase="'aula'">
      <button ion-button light (click)="ElegirAula()">AULA: {{aulaElegida}}</button>
      <button ion-button light (click)="ElegirMateria()" *ngIf="aulaElegida">MATERIA: {{materiaElegidaNombre}}</button>
    </div>
    <div *ngSwitchCase="'materia'">
      <button ion-button light (click)="ElegirMateria()">MATERIA: {{materiaElegidaNombre}}</button>
    </div>
    <div *ngSwitchCase="'profesor'">
      <button ion-button light (click)="ElegirProfesor()">PROFESOR: {{profesorElegido}}</button>
      <button ion-button light (click)="ElegirMateria()" *ngIf="profesorElegido">MATERIA: {{materiaElegidaNombre}}</button>
    </div>
    <div *ngSwitchCase="'alumno'">
      <button ion-button light (click)="ElegirAlumno()">ALUMNO: {{alumnoElegido}}</button>
      <button ion-button light (click)="ElegirMateria()" *ngIf="alumnoElegido">MATERIA: {{materiaElegidaNombre}}</button>
    </div>
  </div>

<ion-card *ngIf="datosTraidos">
  <ion-card-content>
    <form #formListado="ngForm" (ngSubmit)="GuardarAsistencia(formListado)">
      <ion-list>
        <ion-item *ngFor="let item of datosTraidos">
          <p [style.color]="!item.seleccionado && formListado.submitted ? 'red' : null">{{item.apellido}}, {{item.nombre}}</p>
          <input type="radio" name="{{item.idAlumno}}" [value]="1" [(ngModel)]="item.asistencia" (click)="item.seleccionado = true" required>A
          <input type="radio" name="{{item.idAlumno}}" [value]="2" [(ngModel)]="item.asistencia" (click)="item.seleccionado = true">P
          <input type="radio" name="{{item.idAlumno}}" [value]="3" [(ngModel)]="item.asistencia" (click)="item.seleccionado = true">MF
          <input type="radio" name="{{item.idAlumno}}" [value]="4" [(ngModel)]="item.asistencia" (click)="item.seleccionado = true">AJ
        </ion-item>
        <p *ngIf="!formListado.valid && formListado.submitted">No se tom√≥ asistencia a los alumnos marcados con rojo</p>
      </ion-list>
      <button type="submit" ion-button light>GUARDAR</button>
    </form>
  </ion-card-content>
</ion-card>

</ion-content>